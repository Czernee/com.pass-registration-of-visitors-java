# Регистрация посетителей

## Описание

Этот микросервис предназначен для регистрации и управления данными посетителей в отеле. Он предоставляет API для создания, просмотра, обновления и удаления информации о клиентах, а также функциональность для получения списка клиентов, находящихся в отеле на текущий момент.

## Функциональность

*   **Регистрация посетителей:** Добавление информации о новом посетителе (ФИО, паспортные данные, телефон, номер комнаты, даты прибытия и отъезда).
*   **Управление данными:** Обновление и удаление информации о существующих посетителях.
*   **Просмотр списка:** Получение списка всех зарегистрированных посетителей с поддержкой пагинации.
*   **Текущие посетители:** Получение списка посетителей, находящихся в отеле в данный момент времени.
*   **Авторизация:** Защита API с использованием токенов Bearer для безопасного доступа к ресурсам.

## Технологии

*   **Язык программирования:** Java
*   **Фреймворк:** Spring Boot
*   **Безопасность:** Spring Security, JWT
*   **База данных:** PostgreSQL
*   **Управление зависимостями:** Maven
*   **Тестирование:** JUnit, Mockito

## Требования к окружению

*   Java Development Kit (JDK) 11 или выше
*   Maven 
*   Установленная и настроенная база данных
*   Postman или аналогичный инструмент для тестирования API

## Установка и запуск

1.  **Клонирование репозитория:**

    ```
    git clone (https://github.com/Czernee/com.pass-registration-of-visitors-java
    ```

2.  **Настройка базы данных:**

    *   Создайте базу данных для микросервиса.
    *   Настройте параметры подключения к базе данных в файле `application.properties`:
        ```
        spring.datasource.url=jdbc:postgresql://localhost:5432/your_database
        spring.datasource.username=your_username
        spring.datasource.password=your_password
        spring.jpa.hibernate.ddl-auto=update
        ```

3.  **Сборка проекта:**

    *   С использованием Maven:
        ```
        mvn clean install
        ```

4.  **Запуск приложения:**

    *   Запустите приложение с помощью команды:
        ```
        java -jar target/[имя вашего jar файла].jar
        ```
    *   Или запустите из IDE (IntelliJ IDEA, Eclipse и т.д.).

## API Endpoints

### Аутентификация
*   **POST /api/auth/login** - Аутентификация пользователя и получение токена Bearer.

    Запрос:
      ```
      {
          "username": "user",
          "password": "password"
      }
      ```
    Ответ:
    Токен Bearer в ответе.
*   **POST /api/auth/register** - Регистрация нового пользователя.

    Запрос:
      ```
      {
          "username": "newuser",
          "password": "newpassword",
          "email": "newuser@example.com"
      }
      ```
    Ответ:
    Сообщение об успешной регистрации.

### Клиенты
*   **POST /api/clients** - Создание нового клиента.

    Запрос:
      ```
      {
          "fullName": "Иван Иванович Иванов",
          "passport": "1234 567890",
          "phone": "+7 123 456 78 90",
          "room": "101",
          "arrival": "2023-04-01T12:00:00",
          "departure": "2023-04-05T12:00:00"
      }
      ```
    Ответ:
    Информация о созданном клиенте.

*   **GET /api/clients/{id}** - Получение информации о клиенте по ID.

    Ответ:
    Информация о клиенте.

*   **PUT /api/clients/{id}** - Обновление информации о клиенте.

    Запрос:
        ```
        {
            "fullName": "Новое ФИО",
            "passport": "Новый паспорт",
            "phone": "+7 999 999 99 99",
            "room": "202",
            "arrival": "2023-05-01T12:00:00",
            "departure": "2023-05-05T12:00:00"
        }
        ```
    Ответ:
        Информация об обновленном клиенте.

*   **DELETE /api/clients/{id}** - Удаление клиента.

    Ответ:
        Сообщение об успешном удалении.

*   **GET /api/clients** - Получение списка всех клиентов с пагинацией.

    Параметры:
        *   `pageNo` (Integer, optional, default = 0): Номер страницы.
        *   `pageSize` (Integer, optional, default = 10): Размер страницы.
    Ответ:
        Список клиентов с информацией о пагинации.

*   **GET /api/clients/staying** - Получение списка клиентов, находящихся в отеле на данный момент времени, с пагинацией.

    Параметры:
        *   `pageNo` (Integer, optional, default = 0): Номер страницы.
        *   `pageSize` (Integer, optional, default = 10): Размер страницы.
    Ответ:
        Список клиентов, находящихся в отеле, с информацией о пагинации.

*   **GET /api/clients/{clientId}/staying** - Проверка, находится ли клиент с указанным ID в отеле на текущий момент.

    Ответ:
        `true` - если клиент находится в отеле, `false` - если нет.

## Авторизация

Для доступа к защищенным эндпоинтам API требуется токен Bearer. Его можно получить после успешной аутентификации пользователя (см. эндпоинт `/api/auth/login`).
Примеры:
* Доступ к API осуществляется добавлением заголовка `Authorization` в запросы.
* Тип авторизации: `Bearer Token`.
